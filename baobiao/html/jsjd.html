<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><!--为了让 IE 浏览器运行最新的渲染模式-->
    <meta name="renderer" content="webkit"><!--让国产浏览器启用高速模式-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>金属监督报表</title>
    <!--[if lt IE 9]>
    <script src="http://apps.bdimg.com/libs/html5shiv/3.7/html5shiv.min.js"></script>
    <script src="http://apps.bdimg.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/common.css">

    <script src = '../js/jquery-1.8.3.min.js'></script>
    
    <!--<script src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>-->
    <link rel="stylesheet" type="text/css" href="../js/tree_themes/SimpleTree.css"/>
    <script type="text/javascript" src="../js/SimpleTree.js"></script>
    
</head>
<body>


<div class="container right_common">

    <div class="right_top">
        <div class="right_tit b_color left b_radius">
            金属监督报表
        </div>
        <a class="right_tit1 btn btn-default" id="tianbao">
            报表填写
        </a>
        <a class="right_tit1 btn btn-default" href="diy.html">
            返回
        </a>

    </div>
    <div class="clearfix"></div>
    <div class="right_main">
        <table style="margin:0 auto" class="common_table">
            <tbody>
            <tr>
                <td >
                    <a class="btn btn-default"  title="I4028e4f363d6611a0152676d92461a32" href=".jsp?resid=I4028e4f363d6611a0152676d92461a32&id=displaycatalog&catalogid=I8a8a8aa0308027e30152339cf073025a&showbanner=false&user=liulan&password=liulan">火力发电厂金属技术监督报表</a>
                </td>
                <td>
                	<a class="btn btn-default lh_35"  href=".jsp?resid=I4028e4f30cfc711701561191ddd31fec&id=displaycatalog&catalogid=I8a8a8aa0308027e30152339cf073025a&showbanner=false&user=liulan&password=liulan">金属超温报表</a>
                </td>
                 <td>
                	<a class="btn btn-default lh_35" href=".jsp?resid=I4028e4f30cfc7117015611ce7a6d35f1&id=displaycatalog&catalogid=I8a8a8aa0308027e30152339cf073025a&showbanner=false&user=liulan&password=liulan">金属超压报表</a>
                </td>
                
                
                
               
                 <td>
                <a class="btn btn-default"  title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_ZZRZQGDJDQG">主蒸汽管道和再热蒸汽管道及导汽管表</a>
                </td>
                
                
                
                
                
            </tr>
            
           
            <tr> 
              <td><a class="btn btn-default lh_35" title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_ZDJJSJD">支吊架金属监督表</a></td> 
              <td> <a class="btn btn-default lh_35"   title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_GWLXJSJD">高温联箱金属监督表</a></td> 
              <td> <a class="btn btn-default lh_35"   title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_SRMGJSJD">受热面管金属监督表</a></td> 
              <td> <a class="btn btn-default "  title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_QBQSFLQJSJD">汽包或汽水分离器、储水罐金属监督表</a></td> 
            </tr> 
            <tr> 
              <td> <a class="btn btn-default "  title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_GSGDDWLXJSJD">给水管道和低温联箱金属监督表</a></td> 
              <td> <a class="btn btn-default "   title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_QLJBJJSJD">汽轮机部件金属监督表</a></td> 
              <td> <a class="btn btn-default "  title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_FDJBJJSJD">发电机部件金属监督表</a></td> 
              <td> <a class="btn btn-default lh_35"  title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_JGJJSJD">紧固件金属监督表</a></td> 
 
            </tr> 
            <tr> 
              <td> <a class="btn btn-default lh_35"  title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_DXZJJSJD">大型铸件金属监督表</a></td> 
              <td> <a class="btn btn-default lh_35" class='mix_RJBJJSJD' title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_RJBJJSJD">燃机部件金属监督表</a></td> 
               
              <td> <a class="btn btn-default "  title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_FJGZJDYXXM">复检、跟踪和监督运行项目表 </a></td> 
               <td> <a class="btn btn-default"  style="line-height: 15px;"  title="I4028e4f35e120c960155de2394ea3835"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f35e120c960155de2394ea3835&general_type=mix_QTSJBJJSJD">其它受监部件(机组机炉电外其他重点受监部件)金属监督表</a></td> 
            </tr>
           <!--  <tr>
               <td>
                   <a class="btn btn-default lh_35"  title="I4028e4f363d6611a01526765f343191b"  href="http://172.168.100.110:7001/spreadsheet/vision/openresource.jsp?resid=I4028e4f363d6611a01526765f343191b&id=displaycatalog&catalogid=I8a8a8aa0308027e30152339cf073025a&showbanner=false&user=liulan&password=liulan">受热面超温统计表</a>
                </td>
           </tr>  -->
            
            </tbody>
        </table>
    </div>


</div>
<script type="text/javascript" src="../js/base.js"></script>
<script>
    //定义全局变量
    var ctx = window.location.origin;
    var table = $(".common_table");
     //加上模态框
    table.find('td').append("<h1 class='modal_x'></h1>");
    
    //判断当前用户具不具有权限填写报表
    var flag = 0;
    $.ajax({
        url:ctx +"/jsjd/portal/isForword.do?role_code=jsjd",
        dataType:"json",
        success: function(data) {
            flag = data[0].NUM_USER;
        }
    });

    // a 事件委托于 table;单击选中，并改变报表填写的路径
    table.on('click',function(e){
        var ev = e||window.event,_href ="";
        if(ev.target&&ev.target.nodeName == "A"){
            //加上选中效果！
            $(this).find(".modal_x").hide();
            $(ev.target).siblings('.modal_x').show();
           
            var _href1     = $(ev.target).get(0).href, 
            _id =GetRequest(_href1).resid,
            general_type = GetRequest(_href1).general_type; 


             
            switch (_id){
                case "I4028e4f363d6611a0152676d92461a32":
                     _href ="/main?xwl=23Z5K1X3ZF2N&repordCode=HLFDCJSJSJDYBB";
                     break;
                /*case "I4028e4f363d6611a0152675a76f81684":
                    _href = "/main?xwl=23Z5K1X3ZF2N&repordCode=CWCYBB";
                    break;*/
                case "I4028e4f363d6611a01526765f343191b":
                    _href = "/main?xwl=23Z5K1X3ZF2N&repordCode=SRMCWCYTJB";
                    break;
                    //超温
                case "I4028e4f30cfc711701561191ddd31fec":
                    _href = "/main?xwl=23Z5K1X3ZF2N&repordCode=JSCWB";
                    break;  
                case "I4028e4f30cfc7117015611ce7a6d35f1":
                    _href = "/main?xwl=23Z5K1X3ZF2N&repordCode=JSGYB";
                    break;       
                    
                default:
                    _href="";
            }
            switch (general_type) { 
	            case "mix_ZZRZQGDJDQG": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=ZZRZQGDJDQG"  
	                break;             
	            case "mix_ZDJJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=ZDJJSJD"  
	                break;             
	            case "mix_GWLXJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=GWLXJSJD"  
	                break;             
	            case "mix_SRMGJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=SRMGJSJD"  
	                break;             
	            case "mix_QBQSFLQJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=QBQSFLQJSJD"  
	                break;             
	            case "mix_GSGDDWLXJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=GSGDDWLXJSJD"  
	                break;             
	            case "mix_QLJBJJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=QLJBJJSJD"  
	                break;             
	            case "mix_FDJBJJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=FDJBJJSJD"  
	                break;             
	            case "mix_JGJJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=JGJJSJD"  
	                break;             
	            case "mix_DXZJJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=DXZJJSJD"  
	                break;             
	            case "mix_RJBJJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=RJBJJSJD"  
	                break;             
	            case "mix_QTSJBJJSJD": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=QTSJBJJSJD"  
	                break;             
	            case "mix_FJGZJDYXXM": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=FJGZJDYXXM"  
	                break;             
	            case "mix_BPBJGHB": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=BPBJGHB"  
	                break;             
	            case "mix_SBHBGZQKB": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=SBHBGZQKB"  
	                break;             
	            case "mix_YLRQDJNJB": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=YLRQDJNJB"  
	                break;             
	            case "mix_YLRQGLB": 
	                _href="/main?xwl=23Z5K1X3ZF2N&repordCode=YLRQGLB"  
	                break;             
             
         	} 
            var $tb = $("#tianbao");
            if(flag){
                $tb.get(0).href=ctx+"/jsjd"+_href;
            }else{
                $tb.get(0).href="#";
                $tb.attr("disabled","disabled");
            }
        }
        //去除a链接的跳转;
        return false;
    });
    function GetRequest(url) {
        url = url.split('?')[1]; //获取url中"?"符后的字串
        var theRequest ={};
        var  strs = url.split("&");
        for(var i = 0; i < strs.length; i ++) {
            theRequest[strs[i].split("=")[0]]=(strs[i].split("=")[1]);
        }
        return theRequest;
    }
    //双击跳转
    table.on("dblclick", function (e) {
        var ev = e||window.event;
       // var org_id = localStorage.getItem("orgid_baobiao");
        var org_name;
       
        if(org_id == 'a61365e2-969d-4352-b3f8-805027ab9f1d'|| org_id == "c21834b4-1cb0-490f-a2a8-deeaf7f7e065"){
            org_id   = "c21834b4-1cb0-490f-a2a8-deeaf7f7e065"
           // console.log("岱海发电");
            org_name = encodeURI("岱海发电");
        }else if(org_id == "472212af-1977-462b-a74a-a1f36ed6562d"){
            org_name = encodeURI("宁东发电")
        }
         //console.log(org_id);

        if(ev.target&&ev.target.nodeName=="H1"){
            var  _href     = $(ev.target).siblings().get(0).href,
                 _resid    = GetRequest(_href).resid;
            general_type = GetRequest(_href).general_type;
                // _this_url = ctx+"/spreadsheet/vision/openresource.jsp?paramsInfo=[{'name':'org_id','value':'"+org_id+"','displayValue':'"+org_name+"'}]&resid="+_resid +"&id=displaycatalog&catalogid=I8a8a8aa0308027e30152339cf073025a&showbanner=false&user=liulan&password=liulan";
                _this_url = ctx+"/spreadsheet/vision/openresource.jsp?paramsInfo=[{'name':'org_id','value':'"+org_id+"','displayValue':'"+org_name+"'},{'name':'general_type','value':'"+general_type+"'}]&resid="+_resid +"&id=displaycatalog&catalogid=I8a8a8aa0308027e30152339cf073025a&showbanner=false&user=liulan&password=liulan";    
            // console.log(_this_url);
            //console.log(_href);
            window.open(_this_url, "_blank");
        }
       
    });
</script>

</body>

</html>